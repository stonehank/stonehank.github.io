(window.webpackJsonp=window.webpackJsonp||[]).push([[143],{625:function(e){e.exports=JSON.parse('{"content":"<h2 id=\\"reachrouter\\">reach/router</h2>\\n<p><a href=\\"https://github.com/stonehank/sourcecode-analysis/blob/master/source-code.reach-router/README.md\\">完整源码说明注释</a></p>\\n<p>一张导图：</p>\\n<p><img src=\\"/article/img/reachRouter.png\\" alt=\\"\\"></p>\\n<p>几个亮点：</p>\\n<ul>\\n<li>匹配顺序</li>\\n</ul>\\n<p>源码中是使用了一个评分的方法：</p>\\n<ol>\\n<li>先对路径去除头尾的<code>/</code> ，并且按<code>/</code>分割成路径片段数组</li>\\n<li>对数组使用reduce方法计算分值，如下：<pre><code><pre class=\\"hljs\\"><code>let SEGMENT_POINTS = 4;     // 基本分值，每一个路径片段都有\\nlet STATIC_POINTS = 3;      // 静态路径，如：/abc\\nlet DYNAMIC_POINTS = 2;     // 动态路径，如：/:section\\nlet SPLAT_PENALTY = 1;      // 通配符（减分），如：/*，此处遇到通配符会先减去基本分值，再减1分（优先权很低）\\nlet ROOT_POINTS = 1;        // 根路径</code></pre></code></pre>可知优先权排序为：</li>\\n</ol>\\n<p>静态路径 &gt; 动态路径 &gt; 根路径 &gt; 通配符</p>\\n<ul>\\n<li>相对路径</li>\\n</ul>\\n<p>涉及到3个方法：</p>\\n<p><code>./index.js--&gt;createRoute</code></p>\\n<p><code>./lib/utils.js--&gt;resolve</code></p>\\n<p><code>./lib/util.js--&gt;pick</code></p>\\n<p>首先是通过<code>basepath</code>(一个Router自定义属性，用作路径的公共前缀)结合每一个children(即Route Component)的path通过<code>createRoute</code>方法计算出一个绝对路径</p>\\n<p>再通过<code>pick</code>方法与当前<code>pathname</code>(即window.location.pathname)进行匹配，计算得出一个非通配(<em>)路径匹配值(baseuri)，`例如：&#39;a/</em>&#39; --&gt;匹配出 basuri:&#39;/a&#39;`</p>\\n<p>这个baseuri会作为<code>BaseContext</code>(React.createContext)的context传递给内部组件，最后使用<code>resolve</code>方法对Link上的to的路径(可能是绝对路径，也可能是相对路径)搭配<code>baseuri</code>进行解析(转换成绝对路径)，并且跳转</p>\\n<ul>\\n<li>自动focus</li>\\n</ul>\\n<p>对屏幕阅读器特别友好，每次通过Link跳转后，会自动focus到当前跳转对应的Component，也就是不需要再通过大量的tab按钮去寻找内容页面</p>\\n","toc":[{"anchor":"reachrouter","level":2,"text":"reach/router"}],"relatedTags":null,"created_at":"2018-07-08","timeArr":[2018,6,8,0,0,0,0],"title":"reach-router","uuid":"1478ca77fae5cf65527c2cf310fae0e530ea7496","summary":"<h4>reach/router</h4>\\n<p><a href=\\"https://github.com/stonehank/sourcecode-analysis/blob/master/source-code.reach-router/README.md\\">完整源码说明注释</a></p>\\n<p>一张导图：</p>\\n<p>![](/article/img/reachRoute...</p>","slug":"reach-router","sha":"a479afc7ac0daaf4863905d74229db3658f16354"}')}}]);